<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Background Removal Vidéo - trhacknon</title>
<style>
body {
    background-color: #121212;
    color: #00FFAB;
    font-family: 'Consolas', monospace;
    padding: 20px;
}
input, select, button {
    background-color: #222;
    border: 1px solid #00FFAB;
    color: #00FFAB;
    padding: 8px;
    margin: 5px 0;
    font-size: 1rem;
}
button:hover {
    background-color: #00FFAB;
    color: #121212;
    cursor: pointer;
}
.flash {
    border: 1px solid #00FFAB;
    background: #001a0a;
    padding: 10px;
    margin-bottom: 15px;
}
a.download-link {
    color: #00FFAB;
    text-decoration: underline;
}
fieldset {
    border: 1px solid #00FFAB;
    padding: 10px;
    margin-bottom: 15px;
}
legend {
    color: #00FFAB;
    font-weight: bold;
}
label.radio-label {
    margin-right: 20px;
    cursor: pointer;
}
</style>
</head>
<body>
<h1>Background Removal Vidéo - trhacknon</h1>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    {% for msg in messages %}
      <div class="flash">{{ msg }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<form method="POST" enctype="multipart/form-data">
    <label>Vidéo (mp4, mov, avi, mkv, webm):</label><br>
    <input type="file" name="video" accept="video/*" required><br>

    <label>Image de fond (jpg, jpeg, png):</label><br>
    <input type="file" name="background" accept="image/*" required><br>

    <label>Modèle de suppression de background :</label><br>
    <select name="model" required>
        {% for key, desc in models.items() %}
        <option value="{{ key }}" {% if selected_model == key %}selected{% endif %}>{{ key }} - {{ desc }}</option>
        {% endfor %}
    </select><br>

    <fieldset>
        <legend>Options d'utilisation :</legend>
        <label class="radio-label">
            <input type="radio" name="mode" value="with_password" checked> Avec mot de passe (pas de watermark)
        </label>
        <label class="radio-label">
            <input type="radio" name="mode" value="without_password"> Sans mot de passe (watermark discret ajouté)
        </label>
        <br>
        <label for="password">Mot de passe (uniquement si mode avec mot de passe) :</label><br>
        <input type="password" name="password" id="password" placeholder="Entrez le mot de passe"><br>
    </fieldset>

    <button type="submit">Lancer le traitement</button>
</form>

{% if download_url %}
    <h2>Télécharger la vidéo traitée :</h2>
    <a href="{{ download_url }}" class="download-link" target="_blank">{{ download_url }}</a>
{% endif %}

<script>
// Désactivation du champ mot de passe si mode "sans mot de passe"
const radios = document.querySelectorAll('input[name="mode"]');
const passwordInput = document.getElementById('password');

function togglePasswordInput() {
    if(document.querySelector('input[name="mode"]:checked').value === 'with_password') {
        passwordInput.disabled = false;
    } else {
        passwordInput.disabled = true;
        passwordInput.value = '';
    }
}

radios.forEach(radio => {
    radio.addEventListener('change', togglePasswordInput);
});
togglePasswordInput();
</script>

</body>
</html>
